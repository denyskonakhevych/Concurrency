package com.epam.mergesort;

import static org.junit.Assert.*;

import java.util.ArrayList;
import java.util.List;

import org.junit.Before;
import org.junit.Test;

public class ParallelMergeSortTest {

	@Before
	public void setUp() throws Exception {
		
	}

	@Test(expected = IllegalArgumentException.class)
	public void testIllegalArgumentNull() {
		isSorted(null);
	}
	
	@Test
	public void testSingleElementIsSorted() {
		assertTrue(isSorted(new int[] {0}));
	}

	@Test
	public void testArraysIsSorted() {
		assertTrue(isSorted(new int[] {-2, -1, 0, 1, 2}));
	}
	
	@Test
	public void testArraysIsNotSorted() {
		assertFalse(isSorted(new int[] {-2, 0, -1, 1, 2}));
	}
	
	@Test
	public void testSortArray() throws InterruptedException {
		int[] arr = getLongArray();
		ParallelMergeSort pms = new ParallelMergeSort(arr);
		pms.sort();
		assertTrue(isSorted(arr));
	}
	
	@Test
	public void testSortArrayAllNoneElementIsMissed() throws InterruptedException {
		int[] arr = getLongArray();
		List<Integer> list = new ArrayList<>(arr.length);
		for (int i = 0; i < arr.length; i++) {
			list.add(arr[i]);
		}
		ParallelMergeSort pms = new ParallelMergeSort(arr);
		pms.sort();
		for (int elem : arr) {
			list.remove((Integer)elem);
		}
		assertTrue(list.isEmpty());
	}

	private static boolean isSorted(int[] arr) {
		if (arr == null) {
			throw new IllegalArgumentException("Expected array but was: " + arr);
		}
		if (arr.length == 1) {
			return true;
		}
		for(int i = 1; i < arr.length; i++) {
			if(arr[i-1] > arr[i]) {
				return false;
			}
		}
		return true;
	}
	
	private static int[] getLongArray() {
		return new int[] {389, 300, 231, -820, 387, -799, 14, 752, 538, 69, 870, -59, 956, -480, 96, 734, 915, 212, 476, -587, 303, -671, -650, -667, 276, 923, 86, -903, 357, 650, -252, 864, 622, -212, -18, -944, -394, 445, -38, -490, -272, -215, -925, 403, -869, 122, -601, 793, -502, 51, -970, -677, -199, 349, -811, -496, 163, 667, 236, -164, -655, -531, -206, -624, -953, -162, 561, 811, 817, 286, -721, 712, -955, 502, 886, 678, -621, -355, -182, -884, -340, -945, -423, 225, 945, 191, -391, -287, -991, -619, -163, 818, 921, -172, -940, -578, 750, 738, -402, -664, 850, 574, -831, -429, -675, -769, -979, 412, -281, 831, 208, 285, -666, 593, -535, -550, 763, 32, 371, 258, 920, 201, 720, 121, 647, 751, -893, -817, -682, 662, 29, -203, 284, 375, -145, -1, -57, 426, -718, 481, -174, -250, -4, -703, 171, 140, -130, 411, 833, 994, -593, -505, -208, -796, 127, -184, -822, 791, 570, -651, 543, -285, -510, 860, 553, 204, 805, 166, 659, 761, -432, -879, 498, 976, -732, -993, -76, -747, -378, -635, 433, 867, -129, -296, -549, 35, -23, -739, 715, -327, -411, -167, -829, 624, 9, 615, 74, -736, -969, -118, -191, 456, 52, -708, -642, -788, 269, 684, 118, 642, -686, 336, 252, -414, -830, 105, -582, 13, -588, -240, 812, -474, -74, -11, 554, 149, 799, -933, -420, -532, -417, -160, 112, -935, -72, 808, 878, 141, -939, 90, 513, -661, -225, 977, -89, 48, -575, -384, -704, 334, 126, 404, -307, -778, -962, -29, 975, -161, -149, -116, 954, 789, 113, 24, 773, 443, 2, 597, 450, 168, 557, 193, -31, 458, -951, -239, 912, 568, 866, -498, -192, -66, 179, -424, 3, -405, 428, 627, 173, 958, 655, -850, 801, -637, -337, -478, -157, -618, 453, 243, 766, -143, -64, 539, -343, 668, 895, 708, 760, 585, -310, 360, -256, -685, 651, 772, -905, 94, 250, 93, -22, 244, 87, -288, -370, -743, 894, 245, 39, -934, 256, -98, -246, 595, 605, -602, 882, -730, -132, 415, 900, -863, 10, 969, -304, -525, -625, 946, -198, -25, -365, -110, 249, 710, -117, 217, 335, -856, -193, 462, -460, -147, -563, 881, 281, 517, 576, -78, 294, 287, 12, 723, 119, 983, 596, 26, -385, 237, 298, 211, -376, -102, -451, 167, -853, 280, 739, 434, -538, 771, -895, -476, -339, -809, -628, -96, 939, -539, -767, -146, 46, 98, -28, -462, 964, -280, 152, -725, -907, 951, 910, -814, 928, 840, -848, 431, 103, -825, -150, -301, -290, 447, -326, -209, 838, 508, -251, -179, -3, 727, -751, -144, 292, 697, -614, 614, 929, 255, -151, 307, -585, 238, -627, 515, -396, 464, -562, -75, -528, 981, -805, 75, 911, -746, 551, 656, -190, 246, 528, -325, 324, -425, 562, 457, -34, 260, -864, -707, 608, 634, 573, -253, 369, -678, -237, 657, 262, 365, 691, -990, 741, -670, 965, 947, 532, -802, -600, -204, -518, 619, -202, 571, 337, 45, -412, 612, -520, -122, 834, -699, 435, 714, 138, 479, 957, 392, -371, 184, 309, -888, 397, -611, 654, -819, 161, -517, 783, 216, -640, 4, -882, -885, -782, -228, 675, -489, -352, -51, -430, 67, 117, -313, 792, 379, 694, 41, 926, -84, 353, 267, 893, -107, -737, 413, 591, -745, 839, -719, -896, -81, -258, -236, 927, -58, 879, 429, 271, 487, 7, -220, 477, -262, -912, -231, -513, -834, -408, -82, -754, -79, -639, -283, -803, 135, 883, -684, 802, 221, 872, 986, 364, 454, -286, 77, 968, -300, -649, -308, -981, -299, 837, 274, 924, -552, 20, -633, 128, -641, 914, -564, 779, 580, 504, -832, 47, 846, 381, 942, 215, -338, -984, 42, 169, -227, 402, 19, 762, 465, -734, 263, 841, 441, 132, 948, -100, 731, -454, 146, -406, -166, -622, 713, -452, -10, -943, -800, -916, 333, -536, -731, 686, -808, 226, 358, 361, -672, 682, 643, 339, 31, 38, 270, 786, -289, -342, 736, -765, 195, -858, -591, -503, 53, 165, 728, 253, -463, 567, 993, 628, 111, -577, -444, -284, -397, 639, 552, 190, -148, -44, 483, -573, 544, -971, 979, -197, -468, -772, -353, -669, -768, 488, -676, 317, 233, 960, 192, -71, 344, -861, -319, 148, -866, -455, 44, -169, -985, -501, -245, 798, -512, -469, -890, 500, 559, 345, -368, -373, 579, 997, 297, -849, -194, 232, -316, 632, 996, -241, 523, 648, 81, -786, -899, 366, 829, 176, 875, -968, -346, -297, -646, -95, -318, 155, 400, 188, -20, 537, -529, 247, -97, -349, 690, 106, 578, 160, -446, -292, 203, -216, 590, -217, -46, -989, -39, 707, 424, -847, -224, -210, -165, 564, 716, -483, -976, 862, 748, -14, -1000, 420, -793, 151, -781, 709, 677, -188, 737, 175, -214, 490, -400, 89, 162, -638, -576, 775, -244, -62, 494, -410, 99, 826, 120, 23, -135, -404, 91, 273, 869, 843, -921, -606, 521, -486, -995, -312, -311, 451, -274, 726, -63, -842, -717, -715, -351, -852, -645, -399, -9, -609, 318, -711, -561, -403, 83, -616, -763, -759, -92, -88, -764, 732, 259, 962, 658, -693, -886, -581, 630, 943, -366, -413, -347, 455, 143, -742, -900, -114, -605, 938, 842, 857, -688, -119, -77, -694, -519, 373, 293, 440, 468, -592, -828, -766, 806, 229, -226, -108, 719, 299, 892, 794, 884, 54, 144, 863, 909, -974, 711, -275, -937, 396, 239, -608, -807, -348, -124, 347, -298, -647, 486, 370, 288, 492, -330, 49, 530, 952, 278, -749, -152, -706, -465, 351, -398, 803, -380, -987, -941, 898, 851, -865, -810, 329, 154, -835, -324, -598, 991, -93, -540, 177, 421, -218, -774, -439, -213, -369, 296, -973, -234, -418, -472, 687, 240, -543, -499, 409, -345, -878, -891, -915, 959, 241, 609, 780, 941, 790, -500, -85, -698, -680, -839, -599, -695, -50, -442, -794, -572, 174, -982, 437, 822, -360, -127, -994, 749, -392, 653, -927, 692, -257, -83, 527, -683, -780, -282, -697, -484, 57, -260, -755, 496, 18, 625, 343, -470, -992, -466, -612, -306, 599, -733, -957, 331, 906, 565, -626, -753, 603, -125, -826, -65, 795, -372, -761, -359, 60, -565, -556, -838, 825, 742, -27, 80, 125, 493, -416, -920, 520, -965, -390, -461, -443, 747, -947, -629, -917, 672, -966, 764, 326, 698, 5, -928, 180, -851, 460, 489, 399, -229, 637, 835, -870, 963, -648, -597, 787, 422, -375, -946, -883, 327, -105, 777, -859, 592, 688, 376, 136, 11, 581, 109, 85, -205, 319, 56, 142, -506, -857, 855, 583, 853, 827, -701, 889, -112, -49, 671, -106, 703, 251, 290, -956, 769, 472, -52, -47, -61, 470, -176, -963, -254, 73, 516, 877, -491, -435, -409, 681, 302, -643, 145, -727, -315, 503, 133, -180, -458, -238, 432, -16, -617, -821, 92, -309, 767, -824, -801, 824, 316, 587, -922, -419, 696, -787, 311, 746, -566, -91, 372, 374, -293, 922, -843, 110, 178, -177, -131, 478, 8, 706, 616, 949, 640, 268, 781, 890, 913, -804, -930, 594, -967, 626, -495, -662, 545, -261, -6, 427, -568, -459, -196, 198, 966, -328, 804, 495, 124, 765, -760, -68, -841, 254, 788, -407, 116, 967, -958, 907, -833, 888, -923, 755, -579, 950, 629, -514, -713, -173, 753, -333, -115, 620, 310, 37, 200, 473, -714, -477, 819, -950, 322, 261, 182, -277, -887, 569, -36, -632, 264, -894, 1, -551, -654, -207, 689, 97, -960, -867, -303, 816, -481, -911, 385, 674, 62, -41, -929, -335, -511, 828, 459, 899, 757, -136, -233, 461, 743, 940, -558, 550, -90, -724, -792, 823, 613, -488, -972, 410, 992, 858, -547, -278, -69, 55, -120, -155, 480, -393, -926, -665, -798, 224, -975, -86, 386, -874, 897, -889, -158, 0, -255, 393, -696, -415, 6, -679, 71, -302, -268, 974, 821, -427, -909, 652, -868, 871, -516, -434, -168, 785, -775, -323, 768, -557, -860, 665, 961, 282, 342, 931, -762, -875, -421, 664, -812, -379, 444, -652, -595, 398, 70, -437, -876, 661, -266, 418, 778, -978, -30, -230, -5, 58, -485, -139, 925, 196, 525, 800, 607, -381, -185, 277, 645, -181, -521, 695, -387, 610, 100, -426, 423, -776, 756, 507, -752, 618, 205, -908, -544, 485, -854, 301, -13, -555, 814, 809, 227, 36, -570, 153, -914, 518, -111, -523, 917, -247, -178, -660, -320, -620, -631, -623, -128, 416, -901, -35, 989, 158, 589, -358, -269, -938, 323, -363, -467, 185, 830, 388, 722, -813, -389, -248, 139, -37, -154, 430, -948, -567, -756, 467, -43, 419, -560, 638, -456, 352, 606, -918, -219, 852, 234, -317, 646, -56, 807, 187, -880, -242, 815, 598, 549, 68, 123, 206, 328, 186, -321, -361, -998, -48, -341, 844, -448, -690, -263, 356, 990, 649, -603, -445, 102, 972, -634, 407, 601, -55, 199, 506, 157, -906, 509, -712, 156, -153, -881, 266, 65, -964, 953, 382, 873, -673, -554, -422, 401, 916, -952, -845, -322, 79, 308, -789, -221, 25, 189, -54, 745, -910, -497, 560, -249, -692, -658, -53, 330, -913, -509, 683, 865, -332, -374, 693, -431, -45, -273, 291, -109, -267, 313, 729, 718, 617, 970, 985, 660, 463, -877, 16, -541, 721, 880, 497, 257, 776, 265, -195, -689, -777, 847, -186, 64, -492, 876, -276, 699, 704, 101, 782, -545, 987, 955, 28, 854, 588, 586, 363, -569, -32, -42, 181, 904, 63, 17, 514, 346, 312, 998, -457, 701, -362, 391, 61, 885, -644, -716, 76, 784, 861, -386, 546, -791, 314, -534, 33, -961, 469, -773, 377, -740, -823, 34, -94, 66, 896, -723, -720, -986, 700, 306, -175, 848, 491, -726, -613, -138, 566, 22, 466, 394, -259, -171, -533, 78, 673, -232, 524, -291, -797, -744, -142, 439, 988, 194, 512, 114, 717, -395, -104, -548, -837, 295, -785, 584, 774, -728, 933, -475, 522, 547, -977, -126, -264, 730, 604, 223, -19, -507, 903, -784, -473, 936, -790, 644, -691, 40, -559, 577, 676, 172, 542, -73, 442, -383, 796, -709, -546, -80, 501, 635, -771, 934, 868, 548, -441, 362, 631, 535, 332, 663, -377, -898, -401, -681, -657, -487, 623, -159, 973, 901, -314, -271, 999, 325, -526, -12, 305, 471, 213, -836, 641, -211, -806, -294, -450, -87, 210, -996, 15, 338, -988, 95, -265, 556, 108, 72, 744, 555, -668, -687, -464, -748, -350, -705, -141, 533, -329, 448, 529, 536, -750, 572, 321, 275, -200, 84, 228, -983, 856, -729, -610, 725, 390, -949, 499, -700, -504, 558, -954, 436, 810, -862, -447, -527, 131, -103, -428, 982, 147, 724, 449, 272, -783, -630, 685, -542, -33, -223, -530, 679, -522, 367, 104, -24, 159, 315, 129, 621, 137, 740, -537, 935, 354, 874, 887, -183, -133, -931, -663, 230, -818, -449, -553, 482, 235, -471, 27, -222, -997, -846, -354, 669, 350, 320, 540, -453, 30, 531, 980, 908, 446, 995, -636, -170, -515, 134, 115, -580, -758, 735, -574, 511, -659, -243, -615, 220, -70, 978, 575, 380, 414, -433, 222, 452, -15, -980, -388, 702, -156, -295, 283, 395, -936, -356, -735, -779, -873, -331, -21, 932, -479, -919, -508, 219, 348, 602, -67, 82, 438, 891, -201, -571, -674, -367, -187, 905, 207, -604, -584, 197, 918, 484, 107, 202, -871, 633, 541, -932, 88, -7, 600, 378, -741, 474, -594, 859, 666, 214, 984, -137, -2, -60, 355, -17, 340, -722, -840, 845, -357, -904, -121, 919, 636, -959, -702, 813, 770, -583, 519, 425, 59, -123, -816, 21, 130, -438, 836, 832, -596, 417, 582, 733, 670, -482, 218, 971, 611, 279, -738, -999, -586, 405, -493, 384, -855, -99, -902, 759, -494, -101, -334, -140, 505, -524, -189, -872, 902, -344, 930, -364, -436, 209, -815, -757, 937, 563, -770, 341, 820, -40, -590, -844, -942, -235, 754, 475, -382, -440, -8, 289, 183, 359, 534, 170, 304, -113, 406, -656, 383, 150, -795, 849, 43, 248, -589, 242, -924, -607, -827, 758, -26, 368, 510, -892, 408, 50, 705, 797, 164, -336, -710, 680, -897, -134, -270, 526, 944, -653, -305, -279};
	}
}
